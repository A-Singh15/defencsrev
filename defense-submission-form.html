<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Defense Presentation Submission</title>
  <style>
    /* Styling */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root { --primary-dark-purple: #231161; --primary-medium-purple: #463077; --primary-gold: #c99700; --primary-light-gold: #e9d597; --secondary-blue: #26547c; --secondary-gray: #53565a; }
    body { font-family: "Open Sans", Arial, sans-serif; background-color: #f9fafb; color: var(--secondary-gray); line-height: 1.7; padding: 20px; }
    .submission-container { max-width: 800px; margin: 0 auto; background: white; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); padding: 25px; border: 2px solid var(--primary-dark-purple); }
    h1 { text-align: center; margin-bottom: 20px; color: var(--primary-dark-purple); font-size: 24px; }
    h2 { font-size: 1.5rem; font-weight: bold; margin-bottom: 20px; border-bottom: 3px solid var(--primary-gold); padding-bottom: 10px; color: var(--primary-dark-purple); }
    .submission-form { display: flex; flex-direction: column; gap: 15px; }
    .form-group { display: flex; flex-direction: column; gap: 5px; }
    label { font-weight: 600; color: var(--secondary-gray); }
    input, textarea { padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-family: inherit; }
    input:focus, textarea:focus { outline: none; border-color: var(--primary-dark-purple); box-shadow: 0 0 0 2px rgba(35,17,97,0.2); }
    .required { color: #e53e3e; }
    .submit-button { background-color: var(--primary-dark-purple); color: white; padding: 12px; border: none; border-radius: 4px; font-weight: bold; cursor: pointer; margin-top: 10px; transition: background-color 0.2s; }
    .submit-button:hover { background-color: var(--primary-medium-purple); }
    .submit-button:disabled { background-color: #a0aec0; cursor: not-allowed; }
    .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); }
    .modal-content { background-color: white; margin: 15% auto; padding: 20px; border-radius: 8px; max-width: 500px; position: relative; }
    .close-button { position: absolute; top: 10px; right: 15px; font-size: 24px; cursor: pointer; }
    .alert-success { background-color: #c6f6d5; color: #22543d; padding: 15px; border-radius: 4px; }
    .alert-error { background-color: #fed7d7; color: #c53030; padding: 15px; border-radius: 4px; }
    @media (max-width: 768px) { .submission-container { padding: 15px; } }
  </style>
</head>

<body>
  <div class="submission-container">
    <h1>Defense Presentation Submission</h1>
    <h2>Submit Your Defense Presentation</h2>

    <form id="submission-form" class="submission-form">
      <div class="form-group">
        <label for="fullName">Full Name</label>
        <input type="text" id="fullName" name="fullName" required>
        <div class="error-message" id="fullName-error"></div>
      </div>

      <div class="form-group">
        <label for="email">School Email</label>
        <input type="email" id="email" name="email" required>
        <div class="error-message" id="email-error"></div>
      </div>

      <div class="form-group">
        <label for="projectTitle">Project Title</label>
        <input type="text" id="projectTitle" name="projectTitle" required>
        <div class="error-message" id="projectTitle-error"></div>
      </div>

      <div class="form-group">
        <label for="projectDescription">Project Description</label>
        <textarea id="projectDescription" name="projectDescription" rows="4" required></textarea>
        <div class="error-message" id="projectDescription-error"></div>
      </div>

      <div class="form-group">
        <label for="presentationLink">Presentation Link (Google Drive / OneDrive / Dropbox) <span class="required">*</span></label>
        <input type="url" id="presentationLink" name="presentationLink" placeholder="https://drive.google.com/..." required>
        <div class="error-message" id="presentationLink-error"></div>
      </div>

      <div class="form-group">
        <label for="videoLink">YouTube/Vimeo Video Link (Optional)</label>
        <input type="url" id="videoLink" name="videoLink" placeholder="https://youtube.com/watch?v=...">
      </div>

      <button type="submit" id="submit-button" class="submit-button">Submit Presentation</button>
    </form>
  </div>

  <div id="alert-modal" class="modal">
    <div class="modal-content">
      <span class="close-button">&times;</span>
      <div id="alert-message"></div>
    </div>
  </div>

  <script>
    const API_URL = 'https://script.google.com/macros/s/AKfycbz453rlhrl4FScqFah3c8keZApt6pGZPWD5lVW5Hs--zERI6BukOt7Bisls3ZHChcJT/exec';

    const submissionForm = document.getElementById('submission-form');
    const submitButton = document.getElementById('submit-button');
    const alertModal = document.getElementById('alert-modal');
    const alertMessage = document.getElementById('alert-message');
    const closeButton = document.querySelector('.close-button');

    document.addEventListener('DOMContentLoaded', () => {
      closeButton.addEventListener('click', () => alertModal.style.display = 'none');
      window.addEventListener('click', (e) => { if (e.target === alertModal) alertModal.style.display = 'none'; });

      submissionForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        if (!validateForm()) return;

        submitButton.disabled = true;
        submitButton.textContent = 'Submitting...';

        const formData = {
          fullName: document.getElementById('fullName').value.trim(),
          email: document.getElementById('email').value.trim(),
          projectTitle: document.getElementById('projectTitle').value.trim(),
          projectDescription: document.getElementById('projectDescription').value.trim(),
          presentationLink: document.getElementById('presentationLink').value.trim(),
          videoLink: document.getElementById('videoLink').value.trim(),
        };

        try {
          const response = await fetch(API_URL, {
            method: 'POST',
            body: JSON.stringify(formData),
            headers: { 'Content-Type': 'application/json' }
          });

          const result = await response.json();
          if (result.success) {
            showAlert('Submission successful!', 'success');
            submissionForm.reset();
          } else {
            showAlert('Submission failed. Please try again.', 'error');
          }
        } catch (error) {
          console.error('Error submitting form:', error);
          showAlert('Error submitting form.', 'error');
        } finally {
          submitButton.disabled = false;
          submitButton.textContent = 'Submit Presentation';
        }
      });
    });

    function validateForm() {
      let isValid = true;
      document.querySelectorAll('.error-message').forEach(el => el.textContent = '');

      if (document.getElementById('fullName').value.trim().length < 2) {
        document.getElementById('fullName-error').textContent = 'Name is required';
        isValid = false;
      }
      if (!isValidEmail(document.getElementById('email').value.trim())) {
        document.getElementById('email-error').textContent = 'Invalid email address';
        isValid = false;
      }
      if (document.getElementById('projectTitle').value.trim().length < 2) {
        document.getElementById('projectTitle-error').textContent = 'Project title is required';
        isValid = false;
      }
      if (document.getElementById('projectDescription').value.trim().length < 10) {
        document.getElementById('projectDescription-error').textContent = 'Provide a description (at least 10 characters)';
        isValid = false;
      }
      if (!isValidUrl(document.getElementById('presentationLink').value.trim())) {
        document.getElementById('presentationLink-error').textContent = 'Valid presentation link required';
        isValid = false;
      }
      return isValid;
    }

    function isValidEmail(email) {
      const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return re.test(email);
    }

    function isValidUrl(string) {
      try { new URL(string); return true; }
      catch (_) { return false; }
    }

    function showAlert(message, type) {
      alertMessage.innerHTML = `<div class="alert-${type}">${message}</div>`;
      alertModal.style.display = 'block';
    }
  </script>
</body>
</html>
